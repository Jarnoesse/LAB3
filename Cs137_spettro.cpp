#include <iostream>
#include <cmath>
#include <string.h>
#include <TGraphErrors.h>
#include <TAxis.h>
#include <TCanvas.h>
#include <TF1.h>
#include <iomanip>
#include <TFitResultPtr.h>
#include <TFitResult.h>
#include <TLegend.h>
#include <TMultiGraph.h>
#include <TLatex.h>
#include <TMath.h>
using namespace std;

void Cs137_spettro(){

	float chan[]={5.25000000e+02,5.75000000e+02,6.25000000e+02,6.75000000e+02,7.25000000e+02,7.75000000e+02,8.25000000e+02,8.75000000e+02,9.25000000e+02,9.75000000e+02,1.02500000e+03,1.07500000e+03,1.12500000e+03,1.17500000e+03,1.22500000e+03,1.27500000e+03,1.32500000e+03,1.37500000e+03,1.42500000e+03,1.47500000e+03,1.52500000e+03,1.57500000e+03,1.62500000e+03,1.67500000e+03,1.72500000e+03,1.77500000e+03,1.82500000e+03,1.87500000e+03,1.92500000e+03,1.97500000e+03,2.02500000e+03,2.07500000e+03,2.12500000e+03,2.17500000e+03,2.22500000e+03,2.27500000e+03,2.32500000e+03,2.37500000e+03,2.42500000e+03,2.47500000e+03,2.52500000e+03,2.57500000e+03,2.62500000e+03,2.67500000e+03,2.72500000e+03,2.77500000e+03,2.82500000e+03,2.87500000e+03,2.92500000e+03,2.97500000e+03,3.02500000e+03,3.07500000e+03,3.12500000e+03,3.17500000e+03,3.22500000e+03,3.27500000e+03,3.32500000e+03,3.37500000e+03,3.42500000e+03,3.47500000e+03,3.52500000e+03,3.57500000e+03,3.62500000e+03,3.67500000e+03,3.72500000e+03,3.77500000e+03,3.82500000e+03,3.87500000e+03,3.92500000e+03,3.97500000e+03,4.02500000e+03,4.07500000e+03,4.12500000e+03,4.17500000e+03,4.22500000e+03,4.27500000e+03,4.32500000e+03,4.37500000e+03,4.42500000e+03,4.47500000e+03,4.52500000e+03,4.57500000e+03,4.62500000e+03,4.67500000e+03,4.72500000e+03,4.77500000e+03,4.82500000e+03,4.87500000e+03,4.92500000e+03,4.97500000e+03,5.02500000e+03,5.07500000e+03,5.12500000e+03,5.17500000e+03,5.22500000e+03,5.27500000e+03,5.32500000e+03,5.37500000e+03,5.42500000e+03,5.47500000e+03,5.52500000e+03,5.57500000e+03,5.62500000e+03,5.67500000e+03,5.72500000e+03,5.77500000e+03,5.82500000e+03,5.87500000e+03,5.92500000e+03,5.97500000e+03,6.02500000e+03,6.07500000e+03,6.12500000e+03,6.17500000e+03,6.22500000e+03,6.27500000e+03,6.32500000e+03,6.37500000e+03,6.42500000e+03,6.47500000e+03,6.52500000e+03,6.57500000e+03,6.62500000e+03,6.67500000e+03,6.72500000e+03,6.77500000e+03,6.82500000e+03,6.87500000e+03,6.92500000e+03,6.97500000e+03,7.02500000e+03,7.07500000e+03,7.12500000e+03,7.17500000e+03,7.22500000e+03,7.27500000e+03,7.32500000e+03,7.37500000e+03,7.42500000e+03,7.47500000e+03,7.52500000e+03,7.57500000e+03,7.62500000e+03,7.67500000e+03,7.72500000e+03,7.77500000e+03,7.82500000e+03,7.87500000e+03,7.92500000e+03,7.97500000e+03,8.02500000e+03,8.07500000e+03,8.12500000e+03,8.17500000e+03,8.22500000e+03,8.27500000e+03,8.32500000e+03,8.37500000e+03,8.42500000e+03,8.47500000e+03,8.52500000e+03,8.57500000e+03,8.62500000e+03,8.67500000e+03,8.72500000e+03,8.77500000e+03,8.82500000e+03,8.87500000e+03,8.92500000e+03,8.97500000e+03,9.02500000e+03,9.07500000e+03,9.12500000e+03,9.17500000e+03,9.22500000e+03,9.27500000e+03,9.32500000e+03,9.37500000e+03,9.42500000e+03,9.47500000e+03,9.52500000e+03,9.57500000e+03,9.62500000e+03,9.67500000e+03,9.72500000e+03,9.77500000e+03,9.82500000e+03,9.87500000e+03,9.92500000e+03,9.97500000e+03,1.00250000e+04,1.00750000e+04,1.01250000e+04,1.01750000e+04,1.02250000e+04,1.02750000e+04,1.03250000e+04,1.03750000e+04,1.04250000e+04,1.04750000e+04,1.05250000e+04,1.05750000e+04,1.06250000e+04,1.06750000e+04,1.07250000e+04,1.07750000e+04,1.08250000e+04,1.08750000e+04,1.09250000e+04,1.09750000e+04,1.10250000e+04,1.10750000e+04,1.11250000e+04,1.11750000e+04,1.12250000e+04,1.12750000e+04,1.13250000e+04,1.13750000e+04,1.14250000e+04,1.14750000e+04,1.15250000e+04,1.15750000e+04,1.16250000e+04,1.16750000e+04,1.17250000e+04,1.17750000e+04,1.18250000e+04,1.18750000e+04,1.19250000e+04,1.19750000e+04,1.20250000e+04,1.20750000e+04,1.21250000e+04,1.21750000e+04,1.22250000e+04,1.22750000e+04,1.23250000e+04,1.23750000e+04,1.24250000e+04,1.24750000e+04,1.25250000e+04,1.25750000e+04,1.26250000e+04,1.26750000e+04,1.27250000e+04,1.27750000e+04,1.28250000e+04,1.28750000e+04,1.29250000e+04,1.29750000e+04,1.30250000e+04,1.30750000e+04,1.31250000e+04,1.31750000e+04,1.32250000e+04,1.32750000e+04,1.33250000e+04,1.33750000e+04,1.34250000e+04,1.34750000e+04,1.35250000e+04,1.35750000e+04,1.36250000e+04,1.36750000e+04,1.37250000e+04,1.37750000e+04,1.38250000e+04,1.38750000e+04,1.39250000e+04,1.39750000e+04,1.40250000e+04,1.40750000e+04,1.41250000e+04,1.41750000e+04,1.42250000e+04,1.42750000e+04,1.43250000e+04,1.43750000e+04,1.44250000e+04,1.44750000e+04,1.45250000e+04,1.45750000e+04,1.46250000e+04,1.46750000e+04,1.47250000e+04,1.47750000e+04,1.48250000e+04,1.48750000e+04,1.49250000e+04,1.49750000e+04,1.50250000e+04,1.50750000e+04,1.51250000e+04,1.51750000e+04,1.52250000e+04,1.52750000e+04,1.53250000e+04,1.53750000e+04,1.54250000e+04,1.54750000e+04,1.55250000e+04,1.55750000e+04,1.56250000e+04,1.56750000e+04,1.57250000e+04,1.57750000e+04,1.58250000e+04,1.58750000e+04,1.59250000e+04,1.59750000e+04,1.60250000e+04,1.60750000e+04,1.61250000e+04,1.61750000e+04,1.62250000e+04,1.62750000e+04,1.63250000e+04,1.63750000e+04,1.64250000e+04,1.64750000e+04,1.65250000e+04,1.65750000e+04,1.66250000e+04,1.66750000e+04,1.67250000e+04,1.67750000e+04,1.68250000e+04,1.68750000e+04,1.69250000e+04,1.69750000e+04,1.70250000e+04,1.70750000e+04,1.71250000e+04,1.71750000e+04,1.72250000e+04,1.72750000e+04,1.73250000e+04,1.73750000e+04,1.74250000e+04,1.74750000e+04,1.75250000e+04,1.75750000e+04,1.76250000e+04,1.76750000e+04,1.77250000e+04,1.77750000e+04,1.78250000e+04,1.78750000e+04,1.79250000e+04,1.79750000e+04,1.80250000e+04,1.80750000e+04,1.81250000e+04,1.81750000e+04,1.82250000e+04,1.82750000e+04,1.83250000e+04,1.83750000e+04,1.84250000e+04,1.84750000e+04,1.85250000e+04,1.85750000e+04,1.86250000e+04,1.86750000e+04,1.87250000e+04,1.87750000e+04,1.88250000e+04,1.88750000e+04,1.89250000e+04,1.89750000e+04,1.90250000e+04,1.90750000e+04,1.91250000e+04,1.91750000e+04,1.92250000e+04,1.92750000e+04,1.93250000e+04,1.93750000e+04,1.94250000e+04,1.94750000e+04,1.95250000e+04,1.95750000e+04,1.96250000e+04,1.96750000e+04,1.97250000e+04,1.97750000e+04,1.98250000e+04,1.98750000e+04,1.99250000e+04,1.99750000e+04,2.00250000e+04,2.00750000e+04,2.01250000e+04,2.01750000e+04,2.02250000e+04,2.02750000e+04,2.03250000e+04,2.03750000e+04,2.04250000e+04,2.04750000e+04,2.05250000e+04,2.05750000e+04,2.06250000e+04,2.06750000e+04,2.07250000e+04,2.07750000e+04,2.08250000e+04,2.08750000e+04,2.09250000e+04,2.09750000e+04,2.10250000e+04,2.10750000e+04,2.11250000e+04,2.11750000e+04,2.12250000e+04,2.12750000e+04,2.13250000e+04,2.13750000e+04,2.14250000e+04,2.14750000e+04,2.15250000e+04,2.15750000e+04,2.16250000e+04,2.16750000e+04,2.17250000e+04,2.17750000e+04,2.18250000e+04,2.18750000e+04,2.19250000e+04,2.19750000e+04,2.20250000e+04,2.20750000e+04,2.21250000e+04,2.21750000e+04,2.22250000e+04,2.22750000e+04,2.23250000e+04,2.23750000e+04,2.24250000e+04,2.24750000e+04,2.25250000e+04,2.25750000e+04,2.26250000e+04,2.26750000e+04,2.27250000e+04,2.27750000e+04,2.28250000e+04,2.28750000e+04,2.29250000e+04,2.29750000e+04,2.30250000e+04,2.30750000e+04,2.31250000e+04,2.31750000e+04,2.32250000e+04,2.32750000e+04,2.33250000e+04,2.33750000e+04,2.34250000e+04,2.34750000e+04,2.35250000e+04,2.35750000e+04,2.36250000e+04,2.36750000e+04,2.37250000e+04,2.37750000e+04,2.38250000e+04,2.38750000e+04,2.39250000e+04,2.39750000e+04,2.40250000e+04,2.40750000e+04,2.41250000e+04,2.41750000e+04,2.42250000e+04,2.42750000e+04,2.43250000e+04,2.43750000e+04,2.44250000e+04,2.44750000e+04,2.45250000e+04,2.45750000e+04,2.46250000e+04,2.46750000e+04,2.47250000e+04,2.47750000e+04,2.48250000e+04,2.48750000e+04,2.49250000e+04,2.49750000e+04,2.50250000e+04,2.50750000e+04,2.51250000e+04,2.51750000e+04,2.52250000e+04,2.52750000e+04,2.53250000e+04,2.53750000e+04,2.54250000e+04,2.54750000e+04,2.55250000e+04,2.55750000e+04,2.56250000e+04,2.56750000e+04,2.57250000e+04,2.57750000e+04,2.58250000e+04,2.58750000e+04,2.59250000e+04,2.59750000e+04,2.60250000e+04,2.60750000e+04,2.61250000e+04,2.61750000e+04,2.62250000e+04,2.62750000e+04,2.63250000e+04,2.63750000e+04,2.64250000e+04,2.64750000e+04,2.65250000e+04,2.65750000e+04,2.66250000e+04,2.66750000e+04,2.67250000e+04,2.67750000e+04,2.68250000e+04,2.68750000e+04,2.69250000e+04,2.69750000e+04,2.70250000e+04,2.70750000e+04,2.71250000e+04,2.71750000e+04,2.72250000e+04,2.72750000e+04,2.73250000e+04,2.73750000e+04,2.74250000e+04,2.74750000e+04,2.75250000e+04,2.75750000e+04,2.76250000e+04,2.76750000e+04,2.77250000e+04,2.77750000e+04,2.78250000e+04,2.78750000e+04,2.79250000e+04,2.79750000e+04,2.80250000e+04,2.80750000e+04,2.81250000e+04,2.81750000e+04,2.82250000e+04,2.82750000e+04,2.83250000e+04,2.83750000e+04,2.84250000e+04,2.84750000e+04,2.85250000e+04,2.85750000e+04,2.86250000e+04,2.86750000e+04,2.87250000e+04,2.87750000e+04,2.88250000e+04,2.88750000e+04,2.89250000e+04,2.89750000e+04,2.90250000e+04,2.90750000e+04,2.91250000e+04,2.91750000e+04,2.92250000e+04,2.92750000e+04,2.93250000e+04,2.93750000e+04,2.94250000e+04,2.94750000e+04,2.95250000e+04,2.95750000e+04,2.96250000e+04,2.96750000e+04,2.97250000e+04,2.97750000e+04,2.98250000e+04,2.98750000e+04,2.99250000e+04,2.99750000e+04,3.00250000e+04,3.00750000e+04,3.01250000e+04,3.01750000e+04,3.02250000e+04,3.02750000e+04,3.03250000e+04,3.03750000e+04,3.04250000e+04,3.04750000e+04,3.05250000e+04,3.05750000e+04,3.06250000e+04,3.06750000e+04,3.07250000e+04,3.07750000e+04,3.08250000e+04,3.08750000e+04,3.09250000e+04,3.09750000e+04,3.10250000e+04,3.10750000e+04,3.11250000e+04,3.11750000e+04,3.12250000e+04,3.12750000e+04,3.13250000e+04,3.13750000e+04,3.14250000e+04,3.14750000e+04,3.15250000e+04,3.15750000e+04,3.16250000e+04,3.16750000e+04,3.17250000e+04,3.17750000e+04,3.18250000e+04,3.18750000e+04,3.19250000e+04,3.19750000e+04,3.20250000e+04,3.20750000e+04,3.21250000e+04,3.21750000e+04,3.22250000e+04,3.22750000e+04,3.23250000e+04,3.23750000e+04,3.24250000e+04,3.24750000e+04,3.25250000e+04,3.25750000e+04,3.26250000e+04,3.26750000e+04,3.27250000e+04,3.27750000e+04,3.28250000e+04,3.28750000e+04,3.29250000e+04,3.29750000e+04,3.30250000e+04,3.30750000e+04,3.31250000e+04,3.31750000e+04,3.32250000e+04,3.32750000e+04,3.33250000e+04,3.33750000e+04,3.34250000e+04,3.34750000e+04,3.35250000e+04,3.35750000e+04,3.36250000e+04,3.36750000e+04,3.37250000e+04,3.37750000e+04,3.38250000e+04,3.38750000e+04,3.39250000e+04,3.39750000e+04,3.40250000e+04,3.40750000e+04,3.41250000e+04,3.41750000e+04,3.42250000e+04,3.42750000e+04,3.43250000e+04,3.43750000e+04,3.44250000e+04,3.44750000e+04,3.45250000e+04,3.45750000e+04,3.46250000e+04,3.46750000e+04,3.47250000e+04,3.47750000e+04,3.48250000e+04,3.48750000e+04,3.49250000e+04,3.49750000e+04,3.50250000e+04,3.50750000e+04,3.51250000e+04,3.51750000e+04,3.52250000e+04,3.52750000e+04,3.53250000e+04,3.53750000e+04,3.54250000e+04,3.54750000e+04,3.55250000e+04,3.55750000e+04,3.56250000e+04,3.56750000e+04,3.57250000e+04,3.57750000e+04,3.58250000e+04,3.58750000e+04,3.59250000e+04,3.59750000e+04,3.60250000e+04,3.60750000e+04,3.61250000e+04,3.61750000e+04,3.62250000e+04,3.62750000e+04,3.63250000e+04,3.63750000e+04,3.64250000e+04,3.64750000e+04,3.65250000e+04,3.65750000e+04,3.66250000e+04,3.66750000e+04,3.67250000e+04,3.67750000e+04,3.68250000e+04,3.68750000e+04,3.69250000e+04,3.69750000e+04,3.70250000e+04,3.70750000e+04,3.71250000e+04,3.71750000e+04,3.72250000e+04,3.72750000e+04,3.73250000e+04,3.73750000e+04,3.74250000e+04,3.74750000e+04,3.75250000e+04,3.75750000e+04,3.76250000e+04,3.76750000e+04,3.77250000e+04,3.77750000e+04,3.78250000e+04,3.78750000e+04,3.79250000e+04,3.79750000e+04,3.80250000e+04,3.80750000e+04,3.81250000e+04,3.81750000e+04,3.82250000e+04,3.82750000e+04,3.83250000e+04,3.83750000e+04,3.84250000e+04,3.84750000e+04,3.85250000e+04,3.85750000e+04,3.86250000e+04,3.86750000e+04,3.87250000e+04,3.87750000e+04,3.88250000e+04,3.88750000e+04,3.89250000e+04,3.89750000e+04,3.90250000e+04,3.90750000e+04,3.91250000e+04,3.91750000e+04,3.92250000e+04,3.92750000e+04,3.93250000e+04,3.93750000e+04,3.94250000e+04,3.94750000e+04,3.95250000e+04,3.95750000e+04,3.96250000e+04,3.96750000e+04,3.97250000e+04,3.97750000e+04,3.98250000e+04,3.98750000e+04,3.99250000e+04,3.99750000e+04,4.00250000e+04,4.00750000e+04,4.01250000e+04,4.01750000e+04,4.02250000e+04,4.02750000e+04,4.03250000e+04,4.03750000e+04,4.04250000e+04,4.04750000e+04,4.05250000e+04,4.05750000e+04,4.06250000e+04,4.06750000e+04,4.07250000e+04,4.07750000e+04,4.08250000e+04,4.08750000e+04,4.09250000e+04,4.09750000e+04,4.10250000e+04,4.10750000e+04,4.11250000e+04,4.11750000e+04,4.12250000e+04,4.12750000e+04,4.13250000e+04,4.13750000e+04,4.14250000e+04,4.14750000e+04,4.15250000e+04,4.15750000e+04,4.16250000e+04,4.16750000e+04,4.17250000e+04,4.17750000e+04,4.18250000e+04,4.18750000e+04,4.19250000e+04,4.19750000e+04,4.20250000e+04,4.20750000e+04,4.21250000e+04,4.21750000e+04,4.22250000e+04,4.22750000e+04,4.23250000e+04,4.23750000e+04,4.24250000e+04,4.24750000e+04,4.25250000e+04,4.25750000e+04,4.26250000e+04,4.26750000e+04,4.27250000e+04,4.27750000e+04,4.28250000e+04,4.28750000e+04,4.29250000e+04,4.29750000e+04,4.30250000e+04,4.30750000e+04,4.31250000e+04,4.31750000e+04,4.32250000e+04,4.32750000e+04,4.33250000e+04,4.33750000e+04,4.34250000e+04,4.34750000e+04,4.35250000e+04,4.35750000e+04,4.36250000e+04,4.36750000e+04,4.37250000e+04,4.37750000e+04,4.38250000e+04,4.38750000e+04,4.39250000e+04,4.39750000e+04,4.40250000e+04,4.40750000e+04,4.41250000e+04,4.41750000e+04,4.42250000e+04,4.42750000e+04,4.43250000e+04,4.43750000e+04,4.44250000e+04,4.44750000e+04,4.45250000e+04,4.45750000e+04,4.46250000e+04,4.46750000e+04,4.47250000e+04,4.47750000e+04,4.48250000e+04,4.48750000e+04,4.49250000e+04,4.49750000e+04,4.50250000e+04,4.50750000e+04,4.51250000e+04,4.51750000e+04,4.52250000e+04,4.52750000e+04,4.53250000e+04,4.53750000e+04,4.54250000e+04,4.54750000e+04,4.55250000e+04,4.55750000e+04,4.56250000e+04,4.56750000e+04,4.57250000e+04,4.57750000e+04,4.58250000e+04,4.58750000e+04,4.59250000e+04,4.59750000e+04,4.60250000e+04,4.60750000e+04,4.61250000e+04,4.61750000e+04,4.62250000e+04,4.62750000e+04,4.63250000e+04,4.63750000e+04,4.64250000e+04,4.64750000e+04,4.65250000e+04,4.65750000e+04,4.66250000e+04,4.66750000e+04,4.67250000e+04,4.67750000e+04,4.68250000e+04,4.68750000e+04,4.69250000e+04,4.69750000e+04,4.70250000e+04,4.70750000e+04,4.71250000e+04,4.71750000e+04,4.72250000e+04,4.72750000e+04,4.73250000e+04,4.73750000e+04,4.74250000e+04,4.74750000e+04,4.75250000e+04,4.75750000e+04,4.76250000e+04,4.76750000e+04,4.77250000e+04,4.77750000e+04,4.78250000e+04,4.78750000e+04,4.79250000e+04,4.79750000e+04,4.80250000e+04,4.80750000e+04,4.81250000e+04,4.81750000e+04,4.82250000e+04,4.82750000e+04,4.83250000e+04,4.83750000e+04,4.84250000e+04,4.84750000e+04,4.85250000e+04,4.85750000e+04,4.86250000e+04,4.86750000e+04,4.87250000e+04,4.87750000e+04,4.88250000e+04,4.88750000e+04,4.89250000e+04,4.89750000e+04,4.90250000e+04,4.90750000e+04,4.91250000e+04,4.91750000e+04,4.92250000e+04,4.92750000e+04,4.93250000e+04,4.93750000e+04,4.94250000e+04,4.94750000e+04,4.95250000e+04,4.95750000e+04,4.96250000e+04,4.96750000e+04,4.97250000e+04,4.97750000e+04,4.98250000e+04,4.98750000e+04,4.99250000e+04,4.99750000e+04,5.00250000e+04,5.00750000e+04,5.01250000e+04,5.01750000e+04,5.02250000e+04,5.02750000e+04,5.03250000e+04,5.03750000e+04,5.04250000e+04,5.04750000e+04,5.05250000e+04,5.05750000e+04,5.06250000e+04,5.06750000e+04,5.07250000e+04,5.07750000e+04,5.08250000e+04,5.08750000e+04,5.09250000e+04,5.09750000e+04,5.10250000e+04,5.10750000e+04,5.11250000e+04,5.11750000e+04,5.12250000e+04,5.12750000e+04,5.13250000e+04,5.13750000e+04,5.14250000e+04,5.14750000e+04,5.15250000e+04,5.15750000e+04,5.16250000e+04,5.16750000e+04};
	double freq[]={1.00000000e+00,6.00000000e+00,4.00000000e+00,1.50000000e+01,2.00000000e+01,4.20000000e+01,5.40000000e+01,1.09000000e+02,1.92000000e+02,3.28000000e+02,4.38000000e+02,6.47000000e+02,1.02200000e+03,1.68200000e+03,2.52300000e+03,3.43300000e+03,4.78700000e+03,5.48000000e+03,6.59300000e+03,7.21900000e+03,7.74600000e+03,8.05400000e+03,8.36600000e+03,8.56600000e+03,8.52700000e+03,8.97100000e+03,8.75000000e+03,9.01900000e+03,8.72100000e+03,9.05900000e+03,8.89500000e+03,9.13400000e+03,9.10000000e+03,9.02900000e+03,9.03900000e+03,9.05200000e+03,9.19400000e+03,9.12900000e+03,9.25300000e+03,9.09500000e+03,9.29600000e+03,8.93900000e+03,9.31600000e+03,8.93600000e+03,9.19700000e+03,9.16800000e+03,9.07000000e+03,9.28600000e+03,8.92900000e+03,9.13400000e+03,9.16300000e+03,9.01300000e+03,9.06300000e+03,9.06500000e+03,9.00100000e+03,9.18900000e+03,8.83000000e+03,8.83200000e+03,8.89000000e+03,8.82900000e+03,8.70100000e+03,8.59900000e+03,8.76700000e+03,8.47200000e+03,8.75600000e+03,8.54300000e+03,8.59900000e+03,8.39400000e+03,8.21400000e+03,8.37800000e+03,8.19100000e+03,8.22100000e+03,8.00600000e+03,7.96600000e+03,7.89300000e+03,7.90100000e+03,7.97900000e+03,7.86200000e+03,7.54500000e+03,7.63500000e+03,7.52000000e+03,7.34600000e+03,7.52100000e+03,7.37700000e+03,7.16300000e+03,7.12300000e+03,7.15300000e+03,7.02700000e+03,6.94400000e+03,6.65000000e+03,6.81300000e+03,6.69100000e+03,6.62000000e+03,6.33000000e+03,6.27400000e+03,6.18400000e+03,6.22500000e+03,6.32800000e+03,5.88000000e+03,5.80300000e+03,5.89300000e+03,5.77500000e+03,5.74200000e+03,5.54500000e+03,5.42900000e+03,5.44100000e+03,5.21100000e+03,5.10100000e+03,5.02900000e+03,4.97600000e+03,4.86500000e+03,4.88100000e+03,4.62100000e+03,4.60500000e+03,4.56000000e+03,4.29000000e+03,4.29900000e+03,4.38100000e+03,4.18500000e+03,4.21200000e+03,4.06000000e+03,4.01000000e+03,3.78600000e+03,3.90400000e+03,3.81700000e+03,3.66500000e+03,3.71700000e+03,3.59800000e+03,3.60400000e+03,3.54300000e+03,3.40100000e+03,3.21200000e+03,3.30300000e+03,3.20200000e+03,3.04900000e+03,2.98500000e+03,2.98400000e+03,3.05200000e+03,2.83300000e+03,2.84100000e+03,2.74000000e+03,2.84600000e+03,2.66400000e+03,2.68800000e+03,2.48000000e+03,2.52500000e+03,2.38500000e+03,2.40600000e+03,2.34900000e+03,2.37800000e+03,2.29800000e+03,2.21400000e+03,2.18900000e+03,2.16100000e+03,2.14800000e+03,2.12500000e+03,2.04500000e+03,2.11200000e+03,1.92200000e+03,2.03500000e+03,1.99400000e+03,1.89700000e+03,1.95600000e+03,1.82700000e+03,1.86400000e+03,1.77900000e+03,1.84000000e+03,1.75600000e+03,1.76700000e+03,1.72600000e+03,1.74600000e+03,1.67000000e+03,1.64100000e+03,1.62800000e+03,1.65300000e+03,1.66100000e+03,1.66100000e+03,1.57000000e+03,1.56200000e+03,1.54100000e+03,1.61500000e+03,1.59400000e+03,1.45900000e+03,1.54600000e+03,1.52900000e+03,1.57600000e+03,1.56700000e+03,1.55800000e+03,1.52600000e+03,1.58100000e+03,1.51700000e+03,1.53500000e+03,1.59200000e+03,1.51300000e+03,1.52200000e+03,1.59900000e+03,1.54900000e+03,1.51100000e+03,1.60400000e+03,1.51800000e+03,1.57100000e+03,1.50400000e+03,1.63900000e+03,1.58200000e+03,1.56800000e+03,1.58700000e+03,1.65000000e+03,1.64400000e+03,1.58100000e+03,1.50700000e+03,1.56300000e+03,1.59000000e+03,1.67500000e+03,1.58700000e+03,1.48800000e+03,1.59900000e+03,1.57500000e+03,1.62100000e+03,1.60800000e+03,1.64500000e+03,1.59500000e+03,1.58900000e+03,1.57900000e+03,1.56300000e+03,1.58100000e+03,1.51600000e+03,1.50200000e+03,1.55700000e+03,1.51400000e+03,1.48900000e+03,1.54200000e+03,1.51500000e+03,1.49200000e+03,1.45200000e+03,1.47700000e+03,1.43100000e+03,1.43100000e+03,1.40500000e+03,1.39800000e+03,1.34400000e+03,1.37200000e+03,1.33200000e+03,1.31500000e+03,1.25200000e+03,1.25100000e+03,1.26800000e+03,1.24600000e+03,1.17600000e+03,1.14400000e+03,1.10200000e+03,1.13400000e+03,1.15200000e+03,1.08100000e+03,1.06900000e+03,1.03500000e+03,1.01200000e+03,9.48000000e+02,9.02000000e+02,9.13000000e+02,8.78000000e+02,9.21000000e+02,8.72000000e+02,8.47000000e+02,7.74000000e+02,8.12000000e+02,7.13000000e+02,7.18000000e+02,6.56000000e+02,6.59000000e+02,5.98000000e+02,6.55000000e+02,6.13000000e+02,5.52000000e+02,5.37000000e+02,5.33000000e+02,4.85000000e+02,4.74000000e+02,4.54000000e+02,4.09000000e+02,3.85000000e+02,3.62000000e+02,3.67000000e+02,4.09000000e+02,3.45000000e+02,2.81000000e+02,3.10000000e+02,2.61000000e+02,2.59000000e+02,2.44000000e+02,2.51000000e+02,2.36000000e+02,2.50000000e+02,2.16000000e+02,1.83000000e+02,1.96000000e+02,1.64000000e+02,1.61000000e+02,1.74000000e+02,1.57000000e+02,1.33000000e+02,1.28000000e+02,1.17000000e+02,1.00000000e+02,1.06000000e+02,1.14000000e+02,1.06000000e+02,8.70000000e+01,9.40000000e+01,8.70000000e+01,6.90000000e+01,7.60000000e+01,5.70000000e+01,7.80000000e+01,6.60000000e+01,5.90000000e+01,5.00000000e+01,4.60000000e+01,4.80000000e+01,6.40000000e+01,4.10000000e+01,4.40000000e+01,3.60000000e+01,4.00000000e+01,3.30000000e+01,3.30000000e+01,3.40000000e+01,2.60000000e+01,2.60000000e+01,3.20000000e+01,2.30000000e+01,2.60000000e+01,3.40000000e+01,2.40000000e+01,2.00000000e+01,1.70000000e+01,1.60000000e+01,2.40000000e+01,1.90000000e+01,1.60000000e+01,1.90000000e+01,2.30000000e+01,1.80000000e+01,2.10000000e+01,1.70000000e+01,8.00000000e+00,2.10000000e+01,1.40000000e+01,1.70000000e+01,2.30000000e+01,1.00000000e+01,2.00000000e+01,2.00000000e+01,1.70000000e+01,1.00000000e+01,1.30000000e+01,1.20000000e+01,1.00000000e+01,7.00000000e+00,6.00000000e+00,1.70000000e+01,7.00000000e+00,7.00000000e+00,8.00000000e+00,7.00000000e+00,1.80000000e+01,1.20000000e+01,1.10000000e+01,7.00000000e+00,4.00000000e+00,8.00000000e+00,7.00000000e+00,8.00000000e+00,3.00000000e+00,7.00000000e+00,7.00000000e+00,5.00000000e+00,1.00000000e+01,7.00000000e+00,8.00000000e+00,6.00000000e+00,9.00000000e+00,7.00000000e+00,8.00000000e+00,4.00000000e+00,7.00000000e+00,4.00000000e+00,3.00000000e+00,3.00000000e+00,2.00000000e+00,2.00000000e+00,2.00000000e+00,3.00000000e+00,4.00000000e+00,4.00000000e+00,4.00000000e+00,3.00000000e+00,7.00000000e+00,3.00000000e+00,1.00000000e+00,4.00000000e+00,4.00000000e+00,2.00000000e+00,2.00000000e+00,5.00000000e+00,1.00000000e+00,3.00000000e+00,3.00000000e+00,3.00000000e+00,3.00000000e+00,3.00000000e+00,0.00000000e+00,5.00000000e+00,2.00000000e+00,2.00000000e+00,2.00000000e+00,3.00000000e+00,3.00000000e+00,2.00000000e+00,2.00000000e+00,1.00000000e+00,3.00000000e+00,3.00000000e+00,2.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,2.00000000e+00,0.00000000e+00,1.00000000e+00,3.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,3.00000000e+00,0.00000000e+00,2.00000000e+00,1.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,2.00000000e+00,1.00000000e+00,4.00000000e+00,1.00000000e+00,2.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,2.00000000e+00,2.00000000e+00,1.00000000e+00,0.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,2.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,2.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,2.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,1.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00};
	int nBins= 1024 ;
	
	// come si riempie un TH1
	
TCanvas* cCs = new TCanvas("cCs", "Cs", 200, 10, 600, 400);
  cCs->SetFillColor(0);
  cCs->SetGrid();
  cCs->cd();
	
  TH1F *Cs137tot = new TH1F("Cs137tot","Cs137tot",nBins,chan[0],chan[nBins-1]);  
  for (int j=0;j<nBins;j++) {
    Cs137tot->SetBinContent(j+1,freq[j]);
  } 
  Cs137tot->Draw("e1");
   
   TF1* ffit = new TF1("ffit","gaus(0)+pol2(3)",0.,50000);
  ffit->SetParLimits(0,0.,10000.);
  ffit->SetParLimits(1,11000.,13000.);
  ffit->SetParLimits(2,1000.,4000.);
  ffit->SetParNames("Ampl","#mu","#sigma","x0","x1","x2");
  Cs137tot->Fit("ffit","","e1",8500.,16000.);

  //draw components
  TF1* gauscomp = (TF1*)ffit->Clone();
  gauscomp->SetRange(8500.,16000.);
  gauscomp->SetLineColor(kBlue);   gauscomp->SetLineStyle(kDashed);
  gauscomp->SetParameter(3,0.);
  gauscomp->SetParameter(4,0.);
  gauscomp->SetParameter(5,0.);
  TF1* parabcomp = (TF1*)ffit->Clone();
  parabcomp->SetRange(8500.,16000.);
  parabcomp->SetLineColor(kCyan);   parabcomp->SetLineStyle(kDashed);
  parabcomp->SetParameter(0,0.);
  gauscomp->Draw("same");    parabcomp->Draw("same");
  
  TLegend* legend = new TLegend(0.49,0.71,0.89,0.85);
  legend->AddEntry(ffit,"Fit: A_{0} exp(#frac{-(x-#mu)^{2}}{2#sigma^{2}}) + ax^{2}+bx+c","l");
  legend->AddEntry(gauscomp,"A_{0} exp(#frac{-(x-#mu)^{2}}{2#sigma^{2}})","l");
  legend->AddEntry(parabcomp,"ax^{2}+bx+c","l");
  legend->Draw();
  
  cCs->Print("Cs137_cal_CHN.png");
  
  double chn_peak = ffit->GetParameter(1);  // big question: come incertezza cosa usiamo? la sigma della gaussiana?
  double chn_uncert = ffit->GetParameter(2);
  double peak_energy = 624; //keV
  double peak_uncert = 16; //keV
  double k_factor = 624/chn_peak ; // keV/CHN  -->  energy_value = k * CHN_value
  double k_err = k_factor * sqrt(  (16/624)*(16/624) + (chn_uncert/chn_peak)*(chn_uncert/chn_peak)    );
  
  cout << "Chi^2:" << ffit->GetChisquare() << ", number of DoF: " << ffit->GetNDF() << " (Probability: " << ffit->GetProb() << ").\n" << endl;
  
  cout << "Fattore di conversione K: (" << k_factor << " +- " << k_err << " ) keV/CHN " << endl;
   
// rifaccio il grafico (e i fit?) con il grafico in energie

TCanvas* cCse = new TCanvas("cCse", "Cse", 200, 10, 600, 400);
  cCse->SetFillColor(0);
  cCse->SetGrid();
  cCse->cd();

double energy[1024];

for(int i=0; i<nBins;i++){
	energy[i]=k_factor*chan[i];
}



TH1F *Cs137energy = new TH1F("Cs137energy","Cs137energy",nBins,energy[0],energy[nBins-1]);  
  for (int j=0;j<nBins;j++) {
    Cs137energy->SetBinContent(j+1,freq[j]);
  } 
  Cs137energy->Draw("e1"); 
  cCse->Print("Cs137_cal_energy.png"); 
  
  

}
